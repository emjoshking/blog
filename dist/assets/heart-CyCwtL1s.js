import{_ as d,o as p,c as f,a as c,p as w,g}from"./index-D0T7Z4Ha.js";const u={data(){return{context:null,arr:[],starCount:800,rains:[],rainCount:20,windowWidth:window.innerWidth,windowHeight:window.innerHeight,settings:{particles:{length:500,duration:2,velocity:100,effect:-.75,size:20}},particles:null,particleRate:100,time:null,image:null}},mounted(){this.init(),this.createStars(),this.createMeteorRains(),this.playStars(),this.playRains(),this.render(),window.addEventListener("resize",this.onResize)},beforeDestroy(){window.removeEventListener("resize",this.onResize)},methods:{init(){const s=this.$refs.starsCanvas;s&&(s.width=this.windowWidth,s.height=this.windowHeight,this.context=s.getContext("2d"));const t=this.$refs.pinkboardCanvas;t&&(t.width=this.windowWidth,t.height=this.windowHeight,this.pinkboardContext=t.getContext("2d"))},createStars(){for(let s=0;s<this.starCount;s++){const t=new y(this.windowWidth);t.init(),t.draw(this.context),this.arr.push(t)}},createMeteorRains(){for(let s=0;s<this.rainCount;s++){const t=new l(this.windowWidth,this.windowHeight);t.init(),t.draw(this.context),this.rains.push(t)}},playStars(){for(let s=0;s<this.starCount;s++)this.arr[s].getColor(),this.arr[s].draw(this.context);setTimeout(()=>this.playStars(),100)},playRains(){for(let s=0;s<this.rainCount;s++){const t=this.rains[s];t.move(this.context),t.y>this.windowHeight&&(this.context.clearRect(t.x,t.y-t.height,t.width,t.height),this.rains[s]=new l(this.windowWidth,this.windowHeight),this.rains[s].init())}setTimeout(()=>this.playRains(),2)},render(){requestAnimationFrame(this.render.bind(this));const s=new Date().getTime()/1e3,t=s-(this.time||s);this.time=s;const i=this.$refs.pinkboardCanvas;if(i){this.pinkboardContext.clearRect(0,0,i.width,i.height);const e=this.particleRate*t;for(let h=0;h<e;h++){const a=this.pointOnHeart(Math.PI-2*Math.PI*Math.random()),o=a.clone().length(this.settings.particles.velocity);this.particles.add(i.width/2+a.x,i.height/2-a.y,o.x,-o.y)}this.particles.update(t),this.particles.draw(this.pinkboardContext,this.image)}},onResize(){this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight,this.init()},pointOnHeart(s){return new r(160*Math.pow(Math.sin(s),3),130*Math.cos(s)-50*Math.cos(2*s)-20*Math.cos(3*s)-10*Math.cos(4*s)+25)}},created(){this.particles=new x(this.settings.particles.length,this.settings),this.image=(function(){const s=document.createElement("canvas"),t=s.getContext("2d");s.width=this.settings.particles.size,s.height=this.settings.particles.size;function i(o){const n=this.pointOnHeart(o);return n.x=this.settings.particles.size/2+n.x*this.settings.particles.size/350,n.y=this.settings.particles.size/2-n.y*this.settings.particles.size/350,n}t.beginPath();let e=-Math.PI,h=i.call(this,e);for(t.moveTo(h.x,h.y);e<Math.PI;)e+=.01,h=i.call(this,e),t.lineTo(h.x,h.y);t.closePath(),t.fillStyle="#ea80b0",t.fill();const a=new Image;return a.src=s.toDataURL(),a}).call(this)}};class y{constructor(t){this.x=t*Math.random(),this.y=5e3*Math.random(),this.text="❤",this.color="#ea80b0"}getColor(){Math.random()<.5?this.color="#333":this.color="#ea80b0"}init(){this.getColor()}draw(t){t.fillStyle=this.color,t.fillText(this.text,this.x,this.y)}}class l{constructor(t,i){this.x=-1,this.y=-1,this.length=-1,this.angle=30,this.width=-1,this.height=-1,this.speed=1,this.offset_x=-1,this.offset_y=-1,this.alpha=1,this.color1="#ea80b0",this.color2="",this.windowWidth=t,this.windowHeight=i}getRandomColor(){const t=Math.ceil(255-240*Math.random());this.color1="rgba("+t+","+t+","+t+",1)",this.color2="black"}init(){this.getPos(),this.alpha=1,this.getRandomColor();let t=Math.random()*80+150;this.length=Math.ceil(t),this.angle=30,t=Math.random()+.5,this.speed=Math.ceil(t);const i=Math.cos(this.angle*3.14/180),e=Math.sin(this.angle*3.14/180);this.width=this.length*i,this.height=this.length*e,this.offset_x=this.speed*i,this.offset_y=this.speed*e}countPos(){this.x=this.x-this.offset_x,this.y=this.y+this.offset_y}getPos(){this.x=Math.random()*this.windowWidth,this.y=Math.random()*this.windowHeight}draw(t){t.save(),t.beginPath(),t.lineWidth=1,t.globalAlpha=this.alpha;const i=t.createLinearGradient(this.x,this.y,this.x+this.width,this.y-this.height);i.addColorStop(0,"#ea80b0"),i.addColorStop(.3,this.color1),i.addColorStop(.6,this.color2),t.strokeStyle=i,t.moveTo(this.x,this.y),t.lineTo(this.x+this.width,this.y-this.height),t.closePath(),t.stroke(),t.restore()}move(t){const i=this.x+this.width-this.offset_x,e=this.y-this.height;t.clearRect(i-3,e-3,this.offset_x+5,this.offset_y+5),this.countPos(),this.alpha-=.002,this.draw(t)}}class r{constructor(t=0,i=0){this.x=t,this.y=i}clone(){return new r(this.x,this.y)}length(t){return typeof t>"u"?Math.sqrt(this.x*this.x+this.y*this.y):(this.normalize(),this.x*=t,this.y*=t,this)}normalize(){const t=this.length();return this.x/=t,this.y/=t,this}}class v{constructor(){this.position=new r,this.velocity=new r,this.acceleration=new r,this.age=0,this.settings=null}initialize(t,i,e,h,a){this.position.x=t,this.position.y=i,this.velocity.x=e,this.velocity.y=h,this.acceleration.x=e*a.particles.effect,this.acceleration.y=h*a.particles.effect,this.age=0,this.settings=a}update(t){this.position.x+=this.velocity.x*t,this.position.y+=this.velocity.y*t,this.velocity.x+=this.acceleration.x*t,this.velocity.y+=this.acceleration.y*t,this.age+=t}draw(t,i){function e(a){return--a*a*a+1}const h=i.width*e(this.age/this.settings.particles.duration);t.globalAlpha=1-this.age/this.settings.particles.duration,t.drawImage(i,this.position.x-h/2,this.position.y-h/2,h,h)}}class x{constructor(t,i){this.particles=new Array(t),this.firstActive=0,this.firstFree=0,this.duration=i.particles.duration,this.settings=i;for(let e=0;e<this.particles.length;e++)this.particles[e]=new v}add(t,i,e,h){this.particles[this.firstFree].initialize(t,i,e,h,this.settings),this.firstFree++,this.firstFree==this.particles.length&&(this.firstFree=0),this.firstActive==this.firstFree&&this.firstActive++,this.firstActive==this.particles.length&&(this.firstActive=0)}update(t){let i;if(this.firstActive<this.firstFree)for(i=this.firstActive;i<this.firstFree;i++)this.particles[i].update(t);if(this.firstFree<this.firstActive){for(i=this.firstActive;i<this.particles.length;i++)this.particles[i].update(t);for(i=0;i<this.firstFree;i++)this.particles[i].update(t)}for(;this.particles[this.firstActive].age>=this.duration&&this.firstActive!=this.firstFree;)this.firstActive++,this.firstActive==this.particles.length&&(this.firstActive=0)}draw(t,i){if(this.firstActive<this.firstFree)for(let e=this.firstActive;e<this.firstFree;e++)this.particles[e].draw(t,i);if(this.firstFree<this.firstActive){for(let e=this.firstActive;e<this.particles.length;e++)this.particles[e].draw(t,i);for(let e=0;e<this.firstFree;e++)this.particles[e].draw(t,i)}}}const m=s=>(w("data-v-cf8ea896"),s=s(),g(),s),_={id:"app",ref:"app"},C={ref:"starsCanvas",class:"canvas"},M=m(()=>c("span",{class:"word"},"小羊",-1)),A={ref:"pinkboardCanvas",class:"canvas"};function b(s,t,i,e,h,a){return p(),f("div",_,[c("canvas",C,null,512),M,c("canvas",A,null,512)],512)}const R=d(u,[["render",b],["__scopeId","data-v-cf8ea896"]]);export{R as default};
